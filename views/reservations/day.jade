extends ../layout

block head 
  meta(name="turbolinks-cache-control" content="no-cache")

block content
  div(class="container px-5 mx-auto")
    div(class="flex items-center justify-center")
      h1(class='text-4xl')= title

  div(class='h-16')
    while message = flash.shift()
      div.alert(class='alert-' + message.type)
        div(class="text-center py-4 lg:px-4")
          div(class="p-2 bg-red-800 items-center text-indigo-100 leading-none lg:rounded-full flex lg:inline-flex" role="alert")
            span(class="flex rounded-full bg-red-500 uppercase px-2 py-1 text-xs font-bold mr-3")= message.type
            span(class="font-semibold mr-2 text-left flex-auto")= message.message

  div(class="container px-5 mx-auto")
    div(class="flex items-center justify-center")
      a(class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l inline-flex items-center" href=prevLink)
        svg(xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-2" fill='none' viewBox="0 0 24 24" stroke="currentColor")
          path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7")
        span Precedente
      div(class="items-center leading-none text-xl font-bold px-3 py-1")
        span #{params.date}/#{params.month}/#{params.year}
      a(class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-l inline-flex items-center" href=nextLink)
        span Successivo
        svg(xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor")
          path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7")

  section(class="text-gray-600 body-font")
    div(class="container px-5 py-8 mx-auto")
      div(class="flex flex-wrap -m-4")
        each room in rooms
          div(class="p-4 md:w-1/3")
            div(class="h-full border-2 border-gray-200 border-opacity-60 rounded-lg overflow-hidden")
              img(class="lg:h-48 md:h-36 w-full object-cover object-center" src="https://dummyimage.com/720x400" alt="blog")
              div(class="p-6")
                h2(class="tracking-widest text-xs title-font font-medium text-gray-400 mb-1") Stanza
                h1(class="title-font text-lg font-medium text-gray-900 mb-3")= room.name

                each reservation in room.reservations
                  div(class="flex items-center flex-wrap ")
                    div(class="items-center leading-none text-sm pr-3 py-1")= reservation.user.name
                    div(class="items-center leading-none text-sm pr-3 py-1")
                      if(reservation.user._id.equals(user._id))
                        a(href="/reservations/delete/#{reservation._id}", data-remote="true", data-method="delete") Annulla prenotazione
                div(class="flex items-center flex-wrap ")
                  span(class="text-gray-400 mr-3 inline-flex items-center lg:ml-auto md:ml-0 ml-auto leading-none text-sm pr-3 py-1") Posti #{room.capacityLeft}/#{room.capacity}
                div
                  form(action="/reservations/save", data-remote="true", method="post")
                    input(type="hidden", name="year" value=params.year)
                    input(type="hidden", name="month" value=params.month)
                    input(type="hidden", name="date" value=params.date)
                    input(type="hidden", name="room", value=room._id)
                    input(type="submit", value="Prenota" class="flex mx-auto mt-16 text-white bg-green-500 border-0 py-2 px-8 focus:outline-none hover:bg-green-600 rounded text-lg")